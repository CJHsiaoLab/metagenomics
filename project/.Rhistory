divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = c(0, bplot[c(bodysuper)], max(bplot) ) )
axis(1, at = mids)
names(bodysuper)
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, cumsum(bplot[c(bodysuper)]), max(bplot) )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = c(0, bplot[c(bodysuper)], max(bplot) ), labels = "" )
?axis
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, cumsum(bplot[c(bodysuper)]), max(bplot) )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = c(0, bplot[c(bodysuper)], max(bplot) ), labels = FALSE )
axis(1, at = mids, labels = names(bodysuper))
names(bodysuper)
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = mids, labels = names(bodysuper))
mids
max(bplot)
mids <- sapply(1: (length(divides) - 2), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
mids
axis(1, at = c(0, bplot[c(bodysuper)], max(bplot) ), labels = FALSE )
axis(1, at = mids, labels = names(bodysuper))
names(bodysuper)
axis(1, at = mids, labels = names(bodysuper), col = "white")
?axis
bodysuper <- table(metadata_subset$HMPbodysupersite)
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, cumsum(bplot[c(bodysuper)]), max(bplot) )
mids <- sapply(1: (length(divides) - 2), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = c(0, bplot[c(bodysuper)], max(bplot) ), labels = FALSE )
axis(1, at = mids, labels = names(bodysuper), lwd.ticks = 0)
bplot
c(bodysuper)
bodysuper <- table(metadata_subset$HMPbodysupersite)
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, cumsum(bplot[c(bodysuper)]), max(bplot) )
mids <- sapply(1: (length(divides) - 2), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = c(0, bplot[c(bodysuper)], max(bplot) ), labels = FALSE )
bodysuper
bplot
cumsum(bplot[c(bodysuper)])
c(cumsum(bodysuper))
bplot[c(cumsum(bodysuper))]
max(bplot)
bodysuper <- table(metadata_subset$HMPbodysupersite)
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
axis(1, at = c(0, bplot[c(bodysuper)], max(bplot) ), labels = FALSE )
bodysuper <- table(metadata_subset$HMPbodysupersite)
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
axis(1, at = divides, labels = FALSE )
divides
mids <- sapply(1: (length(divides) - 2), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
mids
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
mids
bodysuper <- table(metadata_subset$HMPbodysupersite)
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
axis(1, at = mids, labels = names(bodysuper), lwd.ticks = 0)
axis(1, at = mids, labels = names(bodysuper), lwd.ticks = 0, srt = 45)
bodysuper <- table(metadata_subset$HMPbodysupersite)
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .2, labels = names(bodysuper),
srt = 45, pos = 1, xpd = TRUE)
?text
par("usr")[3]
text(mids, par("usr")[3] - .2, labels = names(bodysuper),
srt = 45, pos = 3, xpd = TRUE)
bodysuper <- table(metadata_subset$HMPbodysupersite)
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .2, labels = names(bodysuper),
srt = 45, pos = 3, xpd = TRUE)
text(mids, par("usr")[3] - .2, labels = names(bodysuper),
srt = 45, pos = 1, adj = 1, xpd = TRUE)
bodysuper <- table(metadata_subset$HMPbodysupersite)
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .2, labels = names(bodysuper),
srt = 45, pos = 1, adj = 1, xpd = TRUE)
# Plot body supersite labels
bodysuper <- table(metadata_subset$HMPbodysupersite)
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .2, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3], labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
# Plot body supersite labels
bodysuper <- table(metadata_subset$HMPbodysupersite)
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
par()$oma
par(mfrow = c(1,1), oma = c(2, 0, 0, 0,))
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
par(mfrow = c(1,1), mar = c(5, 0, 0, 0,))
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
par(mfrow = c(1,1), mar = c(7, 0, 0, 0,))
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
par(mfrow = c(1,1), oma = c(2, 0, 0, 0,0), mar = c(7, 0, 0, 0,))
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
order_otu <- with(metadata_subset, order(HMPbodysupersite, HMPbodysubsite) )
# Plot body supersite labels
bodysuper <- table(metadata_subset$HMPbodysupersite)
par(mfrow = c(1,1), oma = c(2, 0, 0, 0,0), mar = c(7, 0, 0, 0,))
bplot <- barplot(topic_probs[[2]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
# Order of OTUs by body supersites and then by body subsites
order_otu <- with(metadata_subset, order(HMPbodysupersite, HMPbodysubsite) )
# Plot body supersite labels
bodysuper <- table(metadata_subset$HMPbodysupersite)
par(mfrow = c(1,1), oma = c(2, 0, 0, 0,0), mar = c(7, 0, 0, 0))
bplot <- barplot(topic_probs[[2]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
order_otu <- with(metadata_subset, order(HMPbodysupersite, HMPbodysubsite) )
# Plot body supersite labels
bodysuper <- table(metadata_subset$HMPbodysupersite)
par(mfrow = c(1,1), oma = c(2, 0, 0, 0,0), mar = c(7, 0, 0, 0))
bplot <- barplot(topic_probs[[2]][ , order_otu], col = c("red", "green", "blue"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
# Plot body supersite labels
bodysuper <- table(metadata_subset$HMPbodysupersite)
par(mfrow = c(1,1), oma = c(4, 0, 0, 0), mar = c(7, 0, 0, 0))
bplot <- barplot(topic_probs[[2]][ , order_otu], col = c("red", "green", "blue"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
# Plot body supersite labels
bodysuper <- table(metadata_subset$HMPbodysupersite)
par(mfrow = c(1,1), oma = c(3, 0, 0, 0), mar = c(7, 0, 0, 0))
bplot <- barplot(topic_probs[[2]][ , order_otu], col = c("red", "green", "blue"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
# Plot body supersite labels
bodysuper <- table(metadata_subset$HMPbodysupersite)
par(mfrow = c(1,1), oma = c(3, 0, 0, 0), mar = c(5, 0, 0, 0))
bplot <- barplot(topic_probs[[2]][ , order_otu], col = c("red", "green", "blue"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
# Plot body supersite labels
bodysuper <- table(metadata_subset$HMPbodysupersite)
par(mfrow = c(1,1), oma = c(3, 0, 0, 0), mar = c(5, 0, 0, 0))
bplot <- barplot(topic_probs[[2]][ , order_otu], col = c("red", "green", "blue"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 30, pos = 2, adj = 1, xpd = TRUE)
bodysuper <- table(metadata_subset$HMPbodysupersite)
par(mfrow = c(1,1), oma = c(3, 0, 0, 0), mar = c(5, 0, 0, 0))
bplot <- barplot(topic_probs[[2]][ , order_otu], col = c("red", "green", "blue"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 90, pos = 2, adj = 1, xpd = TRUE)
# Plot body supersite labels
bodysuper <- table(metadata_subset$HMPbodysupersite)
par(mfrow = c(1,1), oma = c(3, 0, 0, 0), mar = c(5, 0, 0, 0))
bplot <- barplot(topic_probs[[2]][ , order_otu], col = c("red", "green", "blue"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
order_otu <- with(metadata_subset, order(HMPbodysupersite, HMPbodysubsite) )
# Plot body supersite labels
bodysuper <- table(metadata_subset$HMPbodysupersite)
par(mfrow = c(1,1), oma = c(4, 0, 0, 0), mar = c(5, 0, 0, 0))
bplot <- barplot(topic_probs[[2]][ , order_otu], col = c("red", "green", "blue"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
par(mfrow = c(1,1), oma = c(4, 0, 0, 0), mar = c(5, 3, 3, 0))
bplot <- barplot(topic_probs[[2]][ , order_otu], col = c("red", "green", "blue"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
par(mfrow = c(1,1), oma = c(4, 0, 0, 0), mar = c(5, 3, 3, 0))
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
?barplot
par(mfrow = c(1,1), oma = c(4, 0, 0, 0), mar = c(5, 3, 3, 0))
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F, space = .05)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
par(mfrow = c(1,1), oma = c(4, 0, 0, 0), mar = c(5, 3, 3, 0))
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F, space = .02)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
par(mfrow = c(1,1), oma = c(4, 0, 0, 0), mar = c(5, 3, 3, 0))
bplot <- barplot(topic_probs[[1]][ , order_otu], col = c("red", "green"),
border = NA, axisnames = F, space = 0)
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
rtm.model <- lapply(2:10, function(per_clust) {
rtm.collapsed.gibbs.sampler(input_counts,
input_link,
per_clust,
vocab = input_otus,
num.iterations = 35,
alpha = 0.1,
eta = 0.1, beta = 3)
})
require(broman)
?brocolors
brocolors("main")
brocolors("general")
brocolors("general2")
brocolors("crayon")
brocolors("CCC")
brocolors("CC")
brocolors("f2")
brocolors("crayons")
brocolors("general")
brocolors("general2")
color_vector <- c(brocolors("general"), brocolors("general2")[4])
color_vector
i=5
par(mfrow = c(1,1), oma = c(4, 0, 0, 0), mar = c(5, 3, 3, 0))
bplot <- barplot(topic_probs[[1]][ , order_otu],
col = color_vector[1:clust_vector[i]],
border = NA, axisnames = F, space = 0)
title(main = paste( clust_vector[i], "clusters"))
divides <- c(0, bplot[c(cumsum(bodysuper))] )
clust_vector <- 2:10
color_vector <- c(brocolors("general"), brocolors("general2")[4])
par(mfrow = c(1,1), oma = c(4, 0, 0, 0), mar = c(5, 3, 3, 0))
bplot <- barplot(topic_probs[[1]][ , order_otu],
col = color_vector[1:clust_vector[i]],
border = NA, axisnames = F, space = 0)
title(main = paste( clust_vector[i], "clusters"))
divides <- c(0, bplot[c(cumsum(bodysuper))] )
1:clust_vector[i]
color_vector[1:clust_vector[i]]
par(mfrow = c(1,1), oma = c(4, 0, 0, 0), mar = c(5, 3, 3, 0))
bplot <- barplot(topic_probs[[i]][ , order_otu],
col = color_vector[1:clust_vector[i]],
border = NA, axisnames = F, space = 0)
title(main = paste( clust_vector[i], "clusters"))
divides <- c(0, bplot[c(cumsum(bodysuper))] )
topic_probs <- lapply(1:length(rtm.model), function(per_clust) {
t(t(rtm.model[[per_clust]]$document_sums)/
colSums(rtm.model[[per_clust]]$document_sums))
})
dim(topic_probs[[1]])
par(mfrow = c(1,1), oma = c(4, 0, 0, 0), mar = c(5, 3, 3, 0))
bplot <- barplot(topic_probs[[i]][ , order_otu],
col = color_vector[1:clust_vector[i]],
border = NA, axisnames = F, space = 0)
title(main = paste( clust_vector[i], "clusters"))
divides <- c(0, bplot[c(cumsum(bodysuper))] )
with(metadata_subset, cbind(HMPbodysupersite, HMPbodysubsite))
head( with(metadata_subset, cbind(HMPbodysupersite, HMPbodysubsite)) )
head( with(metadata_subset[order_otu, ], cbind(HMPbodysupersite, HMPbodysubsite)) )
with(metadata_subset[order_otu, ], cbind(HMPbodysupersite, HMPbodysubsite))
clust_vector[i]
topic_probs[[i]][ , order_otu]
brocolor("crayons")[c("Cornflower")]
brocolors("crayons")[c("Cornflower")]
color_vector <- brocolors("crayons")[c("Cornflower", "Navy Blue", "Blue Bell",
"Royal Purple", "Magic Mint", "Green",
"Yellow Green", "Asparagus", "Sunset Orange")]
par(mfrow = c(1,1), oma = c(4, 0, 0, 0), mar = c(5, 3, 3, 0))
bplot <- barplot(topic_probs[[i]][ , order_otu],
col = color_vector[1:clust_vector[i]],
border = NA, axisnames = F, space = 0)
title(main = paste( clust_vector[i], "clusters"))
divides <- c(0, bplot[c(cumsum(bodysuper))] )
mids <- sapply(1: (length(divides) - 1), function(i) {
divides[i] + ( (divides[i+1] - divides[i])/2)
})
axis(1, at = divides, labels = FALSE )
text(mids, par("usr")[3] - .05, labels = names(bodysuper),
srt = 45, pos = 2, adj = 1, xpd = TRUE)
save(rtm.model, file = "./rdas/relation-topic-bodysites.rda")
load("./rdas/relation-topic-bodysites.rda")
!file.exists("../rdas/relation-topics-bodysites.rda")
names(metadata_subset)
# Order of OTUs by indivdiuals
order_subject <- with(metadata_subset, order(hostsubjectid) )
i=2
par(mfrow = c(1,1), oma = c(4, 0, 0, 0), mar = c(5, 3, 3, 0))
bplot <- barplot(topic_probs[[i]][ , order_otu],
col = color_vector[1:clust_vector[i]],
border = NA, axisnames = F, space = 0)
title(main = paste( clust_vector[i], "clusters"))
length(unique(metadata_subset$hostsubjectid))
bplot <- barplot(topic_probs[[i]][ , order_subject],
col = color_vector[1:clust_vector[i]],
border = NA, axisnames = F, space = 0)
bplot
table( metadata_subset$hostsubjectid )
divides <- c( bplot[ c(cumsum(subjects)) ] )
subjects <- table( metadata_subset$hostsubjectid )
divides <- c( bplot[ c(cumsum(subjects)) ] )
divides
subjects <- table( metadata_subset$hostsubjectid )
require(broman)
clust_vector <- 2:10
color_vector <- brocolors("crayons")[c("Cornflower", "Navy Blue", "Blue Bell",
"Royal Purple", "Magic Mint", "Green",
"Yellow Green", "Asparagus", "Sunset Orange")]
par(mfrow = c(1,1), oma = c(4, 0, 0, 0), mar = c(5, 3, 3, 0))
bplot <- barplot(topic_probs[[i]][ , order_subject],
col = color_vector[1:clust_vector[i]],
border = NA, axisnames = F, space = 0)
title(main = paste( clust_vector[i], "clusters"))
divides <- c( bplot[ c(cumsum(subjects)) ] )
abline(v = divides)
abline(v = divides, col = "black", lwd = 2)
?segments
par(mfrow = c(1,1), oma = c(0, 0, 0, 0), mar = c(2, 3, 3, 0))
bplot <- barplot(topic_probs[[i]][ , order_subject],
col = color_vector[1:clust_vector[i]],
border = NA, axisnames = F, space = 0, ylim = c(0, 1.2))
title(main = paste( clust_vector[i], "clusters"))
divides <- c( bplot[ c(cumsum(subjects)) ] )
segments(x0 = divides, x1 = x0,
y0 = 0, y1 = 1.2,
col = "black", lwd = 2)
par(mfrow = c(1,1), oma = c(0, 0, 0, 0), mar = c(2, 3, 3, 0))
bplot <- barplot(topic_probs[[i]][ , order_subject],
col = color_vector[1:clust_vector[i]],
border = NA, axisnames = F, space = 0, ylim = c(0, 1.2))
title(main = paste( clust_vector[i], "clusters"))
divides <- c( bplot[ c(cumsum(subjects)) ] )
segments(x0 = divides, x1 = divides,
y0 = 0, y1 = 1.2,
col = "black", lwd = 2)
par(mfrow = c(1,1), oma = c(0, 0, 0, 0), mar = c(2, 3, 3, 0))
bplot <- barplot(topic_probs[[i]][ , order_subject],
col = color_vector[1:clust_vector[i]],
border = NA, axisnames = F, space = 0, ylim = c(0, 1.2))
title(main = paste( clust_vector[i], "clusters"))
divides <- c( bplot[ c(cumsum(subjects)) ] )
segments(x0 = divides, x1 = divides,
y0 = 0, y1 = 1.2,
col = "black", lwd = 1)
